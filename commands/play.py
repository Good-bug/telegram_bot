# üëã –ó–¥–µ—Å—å –º—ã –ø–æ–¥–∫–ª—é—á–∞–µ–º –Ω—É–∂–Ω—ã–µ —á–∞—Å—Ç–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ telegram
from telegram import Update
from telegram.ext import CommandHandler, MessageHandler, ContextTypes, filters

# üé≤ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å random, —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
import random

# ‚úÖ –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Ç–µ–±—è:
# –ù–∞–ø–∏—à–∏ —Å–ø–∏—Å–æ–∫ –∏–∑ —Ç—Ä—ë—Ö —Å–ª–æ–≤: "–∫–∞–º–µ–Ω—å", "–Ω–æ–∂–Ω–∏—Ü—ã", "–±—É–º–∞–≥–∞"
# –≠—Ç–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫ –∏ –±–æ—Ç
choices = ["–∫–∞–º–µ–Ω—å", "–Ω–æ–∂–Ω–∏—Ü—ã", "–±—É–º–∞–≥–∞"]

# üü¢ –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—à–µ—Ç –∫–æ–º–∞–Ω–¥—É /play, —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è
# –ó–∞–¥–∞–Ω–∏–µ: –ü–æ–ø—Ä–æ—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–±—Ä–∞—Ç—å –∫–∞–º–µ–Ω—å, –Ω–æ–∂–Ω–∏—Ü—ã –∏–ª–∏ –±—É–º–∞–≥—É
async def play_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("–í—ã–±–µ—Ä–∏: –∫–∞–º–µ–Ω—å, –Ω–æ–∂–Ω–∏—Ü—ã –∏–ª–∏ –±—É–º–∞–≥–∞")

# üü° –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –Ω–∞–ø–∏—à–µ—Ç —Å–ª–æ–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä "–∫–∞–º–µ–Ω—å")
async def play_choice(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # üìå –°–æ—Ö—Ä–∞–Ω—è–µ–º, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–ª –∏–≥—Ä–æ–∫, –∏ –¥–µ–ª–∞–µ–º –≤—Å–µ –±—É–∫–≤—ã –º–∞–ª–µ–Ω—å–∫–∏–º–∏
    user_choice = update.message.text.lower()

    # ‚õî –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–∞–ø–∏—Å–∞–ª —á—Ç–æ-—Ç–æ —Å—Ç—Ä–∞–Ω–Ω–æ–µ, –ø—Ä–æ—Å—Ç–æ –≤—ã—Ö–æ–¥–∏–º
    if user_choice not in choices:
        return

    # üéØ –ë–æ—Ç —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
    bot_choice = random.choice(choices)

    # üí≠ –°—á–∏—Ç–∞–µ–º, –∫—Ç–æ –ø–æ–±–µ–¥–∏–ª ‚Äî —Ç—ã –∏–ª–∏ –±–æ—Ç
    result = decide(user_choice, bot_choice)

    # üí¨ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫—É, –∫—Ç–æ –∫–æ–≥–æ –ø–æ–±–µ–¥–∏–ª
    await update.message.reply_text(
        f"–¢—ã –≤—ã–±—Ä–∞–ª: {user_choice}\n–Ø –≤—ã–±—Ä–∞–ª: {bot_choice}\n–†–µ–∑—É–ª—å—Ç–∞—Ç: {result}"
    )

# üîç –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ—à–∞–µ—Ç, –∫—Ç–æ –ø–æ–±–µ–¥–∏–ª
# –ó–∞–¥–∞–Ω–∏–µ: –ø–æ–ø—Ä–æ–±—É–π —Å–∞–º–∞ –ø—Ä–∏–¥—É–º–∞—Ç—å, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è!
# –ü–æ–¥—Å–∫–∞–∑–∫–∞: –∫–∞–º–µ–Ω—å –±—å—ë—Ç –Ω–æ–∂–Ω–∏—Ü—ã, –Ω–æ–∂–Ω–∏—Ü—ã –±—å—é—Ç –±—É–º–∞–≥—É, –±—É–º–∞–≥–∞ –±—å—ë—Ç –∫–∞–º–µ–Ω—å
def decide(user: str, bot: str) -> str:
    if user == bot:
        return "–ù–∏—á—å—è!"  # –µ—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ ‚Äî –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ–±–µ–¥–∏–ª

    # üëâ –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –∫—Ç–æ –∫–æ–≥–æ –ø–æ–±–µ–∂–¥–∞–µ—Ç
    wins = {
        "–∫–∞–º–µ–Ω—å": "–Ω–æ–∂–Ω–∏—Ü—ã",
        "–Ω–æ–∂–Ω–∏—Ü—ã": "–±—É–º–∞–≥–∞",
        "–±—É–º–∞–≥–∞": "–∫–∞–º–µ–Ω—å",
    }

    if wins[user] == bot:
        return "–¢—ã –ø–æ–±–µ–¥–∏–ª!"
    else:
        return "–Ø –ø–æ–±–µ–¥–∏–ª!"

# üì¶ –≠—Ç–∏ —à—Ç—É–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –≤ –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª bot.py
play_command_handler = CommandHandler("play", play_command)
play_choice_handler = MessageHandler(filters.TEXT & (~filters.COMMAND), play_choice)
